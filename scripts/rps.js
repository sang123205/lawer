"use strict";async function out({event:e,api:n,global:s,Config:a,logger:h,Threads:r,Users:o,args:i,body:t,is:d}){const{threadID:g,messageID:c,senderID:l}=e;s.rps||(s.rps=new Map);var I=s.rps.get(g)||{};if("create"==i[0])return s.rps.has(g)?n.sendMessage("Hiện tại đã có nhóm chơi không thể khởi tạo.",g,c):i[1]?1==isNaN(i[1])?n.sendMessage("Số thành viên yêu cầu không hợp lệ!",g,c):i[1]<2?n.sendMessage("Không được nhập số thành viên ít hơn 2 thành viên!",g,c):(s.rps.set(g,{author:l,start:!1,max:i[1],player:[l],choose:[],win:[],lose:[],draw:[]}),n.sendMessage("Đã tạo thành công nhóm chơi mới!\nSố thành viên yêu cầu để bắt đầu game: "+i[1]+" thành viên\nTrạng thái: 1/"+i[1],g,c)):n.sendMessage("Bạn chưa nhập số thành viên yêu cầu!",g,c);if("join"==i[0]){if(!I)return n.sendMessage("Nhóm này hiện chưa có nhóm chơi!",g,c);if(1==I.start)return n.sendMessage("Nhóm này đã bắt đầu trò chơi! bạn không thể tham gia",g,c);if(I.player.some((e=>e.toString()==l)))return n.sendMessage("Bạn đã tham gia nhóm này.",g,c);if(I.player.push(l),I.player.length!=I.max)return n.sendMessage("Trạng thái: "+I.player.length+"/"+I.max,g);n.sendMessage("Trạng thái: "+I.player.length+"/"+I.max,g);var m=await n.getThreadInfo(g);setTimeout((()=>{I.start=!0,n.sendMessage("Đã đủ "+I.max+" người tham gia, đang tạo game vui lòng chờ...",g);var e=["bao","kéo","búa"],a=e[Math.floor(Math.random()*e.length)];setTimeout((()=>{for(var e of(n.sendMessage("Tạo thành công, vui lòng kiểm tra tin nhắn của bot (Nếu không thấy thì kiểm tra trong spam hoặc tin nhắn chờ!)",g),I.player))n.sendMessage("vui lòng reply(Phản hồi) tin nhắn này và chọn số thích ứng với lựa chọn của bạn\n\n1.Kéo\n2.Bao\n3.Búa",e,((e,n)=>{s.reply.push({name:this.config.name,messageID:n.messageID,threadID:g,rps_bot:a,list:m})}))}),1e3)}),100)}return"end"==i[0]?I?I.author!=l?n.sendMessage("Bạn không phải chủ nhóm.",g,c):(s.rps.delete(g),n.sendMessage("Đã xóa nhóm chơi!",g,c)):n.sendMessage("Nhóm này hiện chưa có nhóm chơi!",g,c):void 0}async function reply({event:e,api:n,global:s,Config:a,logger:h,Threads:r,Users:o,reply:i,is:t}){var d=s.rps.get(i.threadID)||{},{win:g,lose:c,draw:l}=d,{rps_bot:I,list:m}=i;if(!d.player.find((n=>n.toString()==e.senderID)))return n.sendMessage("Bạn không phải người trong game!",e.threadID,e.messageID);var D=!0;if("1"==e.body)d.choose.push({senderID:e.senderID,choose:e.body}),"bao"==I?d.win.push({senderID:e.senderID,choose:e.body}):"kéo"==I?d.draw.push({senderID:e.senderID,choose:e.body}):d.lose.push({senderID:e.senderID,choose:e.body}),n.sendMessage("Bạn đã chọn kéo!",e.threadID,e.messageID);else if("2"==e.body)d.choose.push({senderID:e.senderID,choose:e.body}),"bao"==I?d.draw.push({senderID:e.senderID,choose:e.body}):"kéo"==I?d.lose.push({senderID:e.senderID,choose:e.body}):d.win.push({senderID:e.senderID,choose:e.body}),n.sendMessage("Bạn đã chọn bao!",e.threadID,e.messageID);else if("3"==e.body)d.choose.push({senderID:e.senderID,choose:e.body}),"bao"==I?d.lose.push({senderID:e.senderID,choose:e.body}):"kéo"==I?d.win.push({senderID:e.senderID,choose:e.body}):d.draw.push({senderID:e.senderID,choose:e.body}),n.sendMessage("Bạn đã chọn búa!",e.threadID,e.messageID);else{D=!1;n.sendMessage("Bạn cần phải chọn 1 -> 3 thôi nha!",e.threadID,e.messageID)}if(d.player.length==d.choose.length){n.sendMessage("Tất cả mọi người đã chọn xong, cùng xem kết quả nào...",i.threadID);var p="",f="",u="";for(var y of d.win){if(1==y.choose)var b="kéo";else if(2==y.choose)b="bao";else b="búa";if(m.nicknames[y.senderID])v=m.nicknames[y.senderID];else var v=m.userInfo.find((n=>n.id==e.p)).name;p+="- "+v+"("+b+")\n"}for(var M of d.lose){if(1==M.choose)b="kéo";else if(2==M.choose)b="bao";else b="búa";if(m.nicknames[M.senderID])v=m.nicknames[M.senderID];else var v=m.userInfo.find((e=>e.id==M.senderID)).name;f+="- "+v+"("+b+")\n"}for(var k of d.draw){if(1==k.choose)b="kéo";else if(2==k.choose)b="bao";else b="búa";if(m.nicknames[k.senderID])v=m.nicknames[k.senderID];else v=m.userInfo.find((e=>e.id==k.senderID)).name;u+="- "+v+"("+b+")\n"}if(0==d.win.length)p="- Không có ai.\n";if(0==d.lose.length)f="- Không có ai.\n";if(0==d.draw.length)u="- Không có ai.\n";setTimeout((()=>{n.sendMessage("》Bot chọn là "+I+"\n\n》Những người chiến thắng:\n"+p+"\n》Những người thua:\n"+f+"\n》Những người hòa: \n"+u,i.threadID),s.rps.delete(i.threadID)}),900)}else if(1==D){if(m.nicknames[e.senderID])v=m.nicknames[e.senderID];else v=m.userInfo.find((n=>n.id==e.senderID)).name;var w=""+(d.player.length-d.choose.length);n.sendMessage(v+" Đã chọn xong, còn "+w+" người chưa chọn!",i.threadID)}}module.exports={config:{name:"rps",ver:"1.0.0",role:0,author:["Lawer Team"],description:"Game rps.",location:__filename,timestamps:0},onMessage:out};